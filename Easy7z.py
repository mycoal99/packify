import os##Version 1.0 by Michael Haulocation = os.getcwd()name = os.path.basename(location)scriptName = os.path.basename(__file__)[0:-3] ##omits .py# make 7z archiveos.chdir(location)os.system("del "+name+".e7z.exe") #remove old exeif (os.path.isfile("c:\\apps\\utils\\7zip\\7z.exe")):    os.system("c:\\apps\\utils\\7zip\\7z.exe a -t7z easy7z.tmp *")elif (os.path.isfile("c:\\program files\\7-zip\\7z.exe")):    os.system("\"c:\\program files\\7-zip\\7z.exe\" a -t7z easy7z.tmp *")else:    print("could not find 7zip! aborting..")    exit(0)##write config filef = open(location+"\\config.e7z.txt",'w')f.write(""";!@Install@!UTF-8!GUIMode="1"ExtractTitle="7z self extratctor and installer"ExtractDialogText="Extracting: """+name+""""RunProgram="install.bat";!@InstallEnd@!""")f.close()##create executable and clean upos.system("copy /b 7zSD.sfx + config.txt + easy7z.tmp "+scriptName+".e7z.exe")os.system("del easy7z.tmp config.e7z.txt")##move self executing zip to C:\tempos.system("copy "+location+"\\"+scriptName+".e7z.exe " + "C:\\temp")